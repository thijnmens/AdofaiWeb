<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<script src="https://cdn.tailwindcss.com"></script>
	</head>
	<body class="bg-transparent">
		<div
			id="root"
			class="bg-gray-800 opacity-90 h-[600px] rounded-3xl transition ease-in-out duration-1000 overflow-hidden drop-shadow-2xl"
			style="width: 1200px"
		>
			<table>
				<tbody>
					<tr>
						<td>
							<div class="drop-shadow-2xl m-16 w-[500px] h-[500px]">
								<img
									id="cover-image"
									src="data:image/octet-stream;base64,UklGRm4EAABXRUJQVlA4IGIEAADQJACdASqAAHwAPm0qj0WkJKEYvB40SAbEsYBmRmGsANWo8phPM11b53mKgA97nT3Giz9PtvENj8GiiMhOsc7h6jRrH/gpJCAwgggKb7ZU2V6DLIwC8lfSIpzf1jrkwlZpOHKQ/KM9k6+KYg9jdOVFkiXkcfr4WoTSnr4bMMXeDrgv87dPfA2oL5ilnFBnBg4AH3aI+Vm0ELOzutUzlQWrLCcBMWOU49xUP7eztbnmlfMcCqcXS/JZNXkyYvL19DopKPLIyT3aZSidxXcRIiZFDeCuguO/oi+/9gxJ6TED280TL3Eg8Edi5ShhTuaQRf3/JaaFaN9A+SNQbFyNN/nAbFPnamS6NLckbVaqqcyrIN6XGfHkay4qFJXn7HvB+DO8IE9QJknJyjfTB52boEAA/uwQt//kGP3ZfsFwW8WaOc4fgWOxgrRU1H+MAFllnevmOyn7ncZulwXE/HXOSJNANvE6YA10BToP67pTocRVxpSyI6tyHwH1N5VfSu7qLho/CYFswQjd1O/9LoNeL81RTjbn1AxDop2o8c7snkRdI4w+orxk6U3s5jgBr2eRsR+zxb8XRVGCojl+FkDtqNoELAhvuCrHBIR6oyJlLIZEbMSeh5QAEWN1bErShHr4mxuhldMhb0NtlQeVE2Nl0TdM+EHIOSqYUp5DT6Tyb34qYNUr/XTkyeusJRSExH3I3Ntm/8wnEgUYnmAqxJQV39TjoKlRslv2rsk4wFKdoFKStqJzNO2849lG+W4KfWIAwePCob/rl2xI+ImdMn3KTQh/IalfNa3t5KBgcuCeZ3pW1iPgSndE5bhJRc3f/qeUZxft1/1ZoJA25Jbc9IEvhfytddKrcO7ltBBORG76D8fRpGXZtgnQOg2+exmmVfcEk0l2FQf5du64urRZzoLwRgVTeM87H5O1ZtDySZZAl8xhu3rPOdlYl/0LR6D+TJfTbAIWUQhi2H1wG/7LHQtBsXZMedVrXZfEr2TCnx2Q8HGD3ElRYPh9xTJ0QIwNPLWaFzZSpzhMaTNpZYVN6YTg6o1yYmUW3OGWlOouOcLo87YbFa3Evl6Aj1IbGY0zBr+VUxNCLM+6SZrSK58+uT0mwDrCi4GETIfU9QEnt6PieXV9KLUSHbclwX/pEpxPy3LR5YISIepIcOpwbrm6uR8uoCiie4otXkcUfTB33+vF687VvGdweqIUxIaaFPGIoLYuCjEnZ4mG6vDTMWsQx016WN8EGvIXiQQGJp+PbHFWwB/6nqauOu3YlrVneryRxomJzCj7/t8rh6Y9trRJ8tdAIIRXKmSvuTrtgTCv/HaIOdqLWF9VrKT5iktIwnmXoYPzCNBg2vealUIFI6o2vvQrlogOYGdU4SsXyhiuvtebBo3vWt1Xxx9ZrZqaAOZoIGIeIv4cbseFHkphBwPumZ6uVnDr8To+XS91NmVTAECoRynkWpal5cHx9vrGHSRisOdVGtAD+YVm+pGG9UPwrzqxmhegAAA="
									alt="Failed to load"
									class="object-cover rounded-3xl h-[500px] w-[500px]"
									height="500"
									width="500"
								/>
							</div>
						</td>
						<td>
							<div class="">
								<h1 id="song-title" class="text-white text-5xl">Not Playing</h1>
								<h2 id="song-author" class="text-gray-400 text-2xl mt-2">
									Overlay by Thijnmens
								</h2>
								<br />
								<table class="text-3xl align-center text-center">
									<tbody>
										<tr>
											<td id="TE" style="color: #ed3e3e" class="w-6">0</td>
											<td class="w-2"></td>
											<td id="VE" style="color: #eb9a46" class="w-8">0</td>
											<td class="w-2"></td>
											<td id="EP" style="color: #e3e370" class="w-8">0</td>
											<td class="w-2"></td>
											<td id="PP" style="color: #86e370" class="w-8">0</td>
											<td class="w-2"></td>
											<td id="LP" style="color: #e3e370" class="w-8">0</td>
											<td class="w-2"></td>
											<td id="VL" style="color: #eb9a46" class="w-8">0</td>
											<td class="w-2"></td>
											<td id="TL" style="color: #ed3e3e" class="w-8">0</td>
											<td class="w-2"></td>
											<td class="w-4" />
											<!--<td id="difficulty" style="color: #e3e370" class="w-8">
												<strong>Normal</strong>
											</td>-->
										</tr>
									</tbody>
								</table>
								<br />
								<table class="text-3xl align-center text-justify text-white">
									<tbody>
										<tr>
											<td id="death-counter" class="w-32">üíÄ 0</td>
											<td id="checkpoint-counter" class="w-32">üö© 0</td>
											<td id="attempt-counter" class="w-32">üèÜ 0</td>
										</tr>
									</tbody>
								</table>
								<div class="h-6"></div>
								<div class="w-80 h-8 bg-gray-600 mt-4">
									<div
										id="progress-bar"
										class="h-8 bg-green-600 transition duration-200 ease-in-out"
										style="width: 0%"
									></div>
								</div>
								<br />
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<script lang="js">
			const socket = new WebSocket('ws://localhost:420/server');

			socket.addEventListener('open', (event) => {
				socket.send('connect')
			})

			socket.addEventListener('message', (event) => {
				const jsonData = JSON.parse(event.data)
				if (jsonData.type === 'update') {
					document.getElementById('root').style = 'width: 1200px'

					document.getElementById('song-title').textContent = jsonData.levelData.song.replace(/<\/?[^>]+(>|$)/g, '');;
					document.getElementById('song-author').textContent = jsonData.levelData.author.replace(/<\/?[^>]+(>|$)/g, '');;
					/*if (jsonData.levelData.difficulty === 0) {
						document.getElementById('difficulty').textContent = "Lenient";
						document.getElementById('difficulty').style = "color: #86e370";
					} else if (jsonData.levelData.difficulty === 1) {
						document.getElementById('difficulty').textContent = "Normal";
						document.getElementById('difficulty').style = "color: #e3e370";
					} else if (jsonData.levelData.difficulty === 5) {
						document.getElementById('difficulty').textContent = "Strict";
						document.getElementById('difficulty').style = "color: #ed3e3e";
					}*/
					document.getElementById('TE').textContent = jsonData.data.tooEarly;
					document.getElementById('VE').textContent = jsonData.data.veryEarly;
					document.getElementById('EP').textContent = jsonData.data.earlyPerfect;
					document.getElementById('PP').textContent = jsonData.data.perfect;
					document.getElementById('LP').textContent = jsonData.data.latePerfect;
					document.getElementById('VL').textContent = jsonData.data.veryLate;
					document.getElementById('TL').textContent = jsonData.data.tooLate;
					document.getElementById('death-counter').textContent = "üíÄ " + jsonData.data.deaths;
					document.getElementById('checkpoint-counter').textContent = "üö© " + jsonData.data.checkpoints;
					document.getElementById('attempt-counter').textContent = "üèÜ " + jsonData.data.attempts;
					document.getElementById('progress-bar').style = `width: ${jsonData.data.percentComplete*100}%`;
				} else if (jsonData.type === 'sceneChange') {
					console.log(`data:image/${jsonData.data.extension};${jsonData.data.previewImage}`)
					document.getElementById('cover-image').src = `data:image/${jsonData.data.extension};base64, ${jsonData.data.previewImage}`;
				} else {
					document.getElementById('root').style = 'width: 0%'
				}
			})
		</script>
	</body>
</html>
